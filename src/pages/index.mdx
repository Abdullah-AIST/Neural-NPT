---
layout: ../layouts/Layout.astro
title: "Neural-NPT: A Reinforcement Learning Perspective to Dynamic Non-Prehensile Object Transportation"
description: A project page for Neural-NPT
favicon: favicon.svg
thumbnail: screenshot-light.png
---

import Header from "../components/Header.astro";
import Video from "../components/Video.astro";
import HighlightedSection from "../components/HighlightedSection.astro";
import SmallCaps from "../components/SmallCaps.astro";
import Figure from "../components/Figure.astro";
import Image from "../components/Image.astro";
import TwoColumns from "../components/TwoColumns.astro";
import ThreeColumns from "../components/ThreeColumns.astro";
import YouTubeVideo from "../components/YouTubeVideo.astro";
import LaTeX from "../components/LaTeX.astro";

import { ImageComparison } from "../components/ImageComparison.tsx";

import outside from "../assets/Supplementary Video.mp4";
import pyb_vid from "../assets/Pybullet_Collision.webm";
import transformer from "../assets/transformer.webp";
import Splat from "../components/Splat.tsx"
import dogsDiffc from "../assets/dogs-diffc.png"
import dogsTrue from "../assets/dogs-true.png"


import CodeBlock from "../components/CodeBlock.astro";
import Table from "../components/Table.astro";
export const components = {pre: CodeBlock, table: Table}

<Header
  title={frontmatter.title}
  authors={[
    {
      name: "Author one",
      //url: "https://roman.technology",
      institution: "Independent",
      notes: ["*", "†"],
    },
    {
      name: "Author Two",
      institution: "Institution Two",
      notes: ["*", "†"],
    },
    {
      name: "Author Three",
      institution: "Institution Three",
      notes: ["†"],
    },
    {
      name: "Author Four",
      institution: "Institution Four",
    },
  ]}
  conference="Robotics and Automation Letters (RAL) 2025"
  notes={[
    {
      symbol: "*",
      text: "author note one",
    },
    {
      symbol: "†",
      text: "author note two",
    },
  ]}
  links={[
    {
      name: "Paper",
      url: "",
      icon: "ri:file-pdf-2-line",
    },
    {
      name: "Code",
      url: "https://abdullah-aist.github.io/Neural-NPT/",
      icon: "ri:github-line",
    },
    {
      name: "arXiv",
      url: "",
      icon: "academicons:arxiv",
    }
  ]}
  />

<Video source={outside} />

<HighlightedSection>

## Abstract

This work proposes a learning-based approach to dynamic non-prehensile object transportation (e.g., "Waiter's Problem"). Model-based approaches start with a strong dynamic grasping assumption and optimize trajectories under such constraints. However, this optimization process is prone to failure, slow convergence, or suboptimal solutions due to the constraints imposed by dynamic grasping. To address these limitations, we propose a motion-planning neural policy learned via reinforcement learning. The task is formulated as a Markov decision problem, with carefully designed observation space, action space, and reward formulation. Acceleration-based action was crucial for smooth trajectory generation and sim2real transferability. Prior to training, the sim2real robot dynamics gap was minimized through system identification. Towards generalization to wide range of objects, we randomized object size, friction, mass, center of mass, and initial pose during training. By curating the randomization process, different policies are obtained including an "Optimal" policy with full observability and a "Robust" policy under partial observability of object inertia and pose. The trained policy is used for offline trajectory planning, resulting in fast and robust trajectories successfully deployed in both simulated and physical environments. Both our "Optimal" and "Robust" policies had higher peak velocities and accelerations, and shorter reaching times compared to the model-based baseline.

</HighlightedSection>

# Real-world Validation
<h3 style="text-align: center">------------------------------</h3>
## Transport Anything
Randomly swapping objects during exection of Optimal policy optimized for the WoodBlock. Learned trajectories is stable under arbitrary objects. 
<Figure>
  <YouTubeVideo slot="figure" videoId="MJLgvKNcebw" />
  <span slot="caption">Optimal Policy [32/32]</span>
</Figure>
## Optimal Vs. Optimal-DG 

Optimal is faster but may not be as stable for long time operation

<h3 style="text-align: center">--------------- (WoodBlock) ---------------</h3>
<ThreeColumns>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="v964eNtG6V8" />
    <span slot="caption">Optimal Policy -- <strong>N.C.S.</strong> [32/32]</span>
  </Figure>
  <Figure slot="center">
    <YouTubeVideo slot="figure" videoId="sYLbvGEPlGY" />
    <span slot="caption">Optimal-DG Policy -- <strong>N.C.S.</strong> [32/32]</span>
  </Figure>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="rvBT0EBpbfs" />
    <span slot="caption">Upright Baseline -- <strong>N.C.S.</strong> [29/32]</span>
  </Figure>
</ThreeColumns>

<h3 style="text-align: center">--------------- (Chips) ---------------</h3>

<ThreeColumns>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="WJdUwITaY34" />
    <span slot="caption">Optimal Policy -- <strong>N.C.S.</strong> [32/32]</span>
  </Figure>
  <Figure slot="center">
    <YouTubeVideo slot="figure" videoId="ITR15S27lao" />
    <span slot="caption">Optimal-DG Policy -- <strong>N.C.S.</strong> [32/32]</span>
  </Figure>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="34y-fJQ8hoc" />
    <span slot="caption">Upright Baseline -- <strong>N.C.S.</strong> [31/32]</span>
  </Figure>
</ThreeColumns>

<h3 style="text-align: center">--------------- (CrackerBox) ---------------</h3>
<ThreeColumns>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="6jBM9eprjSg" />
    <span slot="caption">Optimal Policy -- <strong>N.C.S.</strong> [32/32]</span>
  </Figure>
  <Figure slot="center">
    <YouTubeVideo slot="figure" videoId="VqgffYWCYBQ" />
    <span slot="caption">Optimal-DG Policy -- <strong>N.C.S.</strong> [32/32]</span>
  </Figure>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="1G9t_jd6FXI" />
    <span slot="caption">Upright Baseline -- <strong>N.C.S.</strong> [28/32]</span>
  </Figure>
</ThreeColumns>

<h3 style="text-align: center">--------------- (BleachCleanser) ---------------</h3>
<ThreeColumns>
  <Figure slot="left">
    <span slot="caption">Optimal Policy -- <strong>S.R.</strong> [32/32]</span>
  </Figure>
  <Figure slot="center">
    <YouTubeVideo slot="figure" videoId="W7LNpjGxQC8" />
    <span slot="caption">Optimal-DG Policy -- <strong>S.R.</strong> [32/32]</span>
  </Figure>
  <Figure slot="right">
    <span slot="caption">Upright Baseline -- <strong>S.R.</strong> [30/32]</span>
  </Figure>
</ThreeColumns>
<ThreeColumns>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="c6xx1Tetu4M" />
    <span slot="caption">Optimal Policy -- <strong>N.C.S.</strong> [12/32]</span>
  </Figure>
  <Figure slot="center">
    <YouTubeVideo slot="figure" videoId="jUCgVkvo1g8" />
    <span slot="caption">Optimal-DG Policy -- <strong>N.C.S.</strong> [22/32]</span>
  </Figure>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="cArGAAFWHBw" />
    <span slot="caption">Upright Baseline -- <strong>N.C.S.</strong> [30/32]</span>
  </Figure>
</ThreeColumns>

<h3 style="text-align: center">--------------- (TallBox-Center) ---------------</h3>
<ThreeColumns>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="Szj-6F07oy0" />
    <span slot="caption">Optimal Policy -- <strong>S.R.</strong> [30/32]</span>
  </Figure>
  <Figure slot="center">
    <YouTubeVideo slot="figure" videoId="Au8u80Ux4Qo" />
    <span slot="caption">Optimal-DG Policy -- <strong>S.R.</strong> [32/32]</span>
  </Figure>
  <Figure slot="right">
    <span slot="caption">Upright Baseline -- <strong>S.R.</strong> [30/32]</span>
  </Figure>
</ThreeColumns>
<ThreeColumns>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="qDl7Of0KIs8" />
    <span slot="caption">Optimal Policy -- <strong>N.C.S.</strong> [14/32]</span>
  </Figure>
  <Figure slot="center">
    <YouTubeVideo slot="figure" videoId="OT3vkAD3uhw" />
    <span slot="caption">Optimal-DG Policy -- <strong>N.C.S.</strong> [32/32]</span>
  </Figure>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="lpckEQ3DGn4" />
    <span slot="caption">Upright Baseline -- <strong>N.C.S.</strong> [24/32]</span>
  </Figure>
</ThreeColumns>

## COM-Robust Vs. Optimal

For objects with inertia uncertainity, COM-Robust policy is more stable yet slower.

<h3 style="text-align: center">--------------- (Power Drill) ---------------</h3>
<ThreeColumns>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="X2jrGfXT7DA" />
    <span slot="caption">COM-Robust Policy -- <strong>S.R.</strong> [14/32]</span>
  </Figure>
  <Figure slot="center">
    <span slot="caption">Optimal Policy -- <strong>S.R.</strong> [0/32]</span>
  </Figure>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="l0QCRPN3GZg" />
    <span slot="caption">Upright-Robust Baseline -- <strong>S.R.</strong> [24/32]</span>
  </Figure>
</ThreeColumns>
<ThreeColumns>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="ATX4jsaAYhs" />
    <span slot="caption">COM-Robust Policy -- <strong>N.C.S.</strong> [14/32]</span>
  </Figure>
  <Figure slot="center">
    <YouTubeVideo slot="figure" videoId="RoY0br8Qn28" />
    <span slot="caption">Optimal Policy -- <strong>N.C.S.</strong> [0/32]</span>
  </Figure>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="Hte49KuQmUE" />
    <span slot="caption">Upright-Robust Baseline -- <strong>N.C.S.</strong> [*/32]</span>
  </Figure>
</ThreeColumns>

<h3 style="text-align: center">--------------- (Pitcher) ---------------</h3>
<ThreeColumns>
  <Figure slot="left">
    <span slot="caption">COM-Robust Policy -- <strong>S.R.</strong> [32/32]</span>
  </Figure>
  <Figure slot="center">
    <YouTubeVideo slot="figure" videoId="_7Qn9doY_UI" />
    <span slot="caption">Optimal Policy -- <strong>S.R.</strong> [28/32]</span>
  </Figure>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="qZPvyWvoFpU" />
    <span slot="caption">Upright-Robust Baseline -- <strong>S.R.</strong> [24/32]</span>
  </Figure>
</ThreeColumns>
<ThreeColumns>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="1mF-UcuJ4vY" />
    <span slot="caption">COM-Robust Policy -- <strong>N.C.S.</strong> [25/32]</span>
  </Figure>
  <Figure slot="center">
    <YouTubeVideo slot="figure" videoId="mVLbxQnohHo" />
    <span slot="caption">Optimal Policy -- <strong>N.C.S.</strong> [2/32]</span>
  </Figure>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="UW1CwZUFwXo" />
    <span slot="caption">Upright-Robust Baseline -- <strong>N.C.S.</strong> [*/32]</span>
  </Figure>
</ThreeColumns>

<h3 style="text-align: center">--------------- (TallBox-Top) ---------------</h3>
<ThreeColumns>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="fIJBYcOQ1eM" />
    <span slot="caption">COM-Robust Policy -- <strong>S.R.</strong> [32/32]</span>
  </Figure>
  <Figure slot="center">
    <YouTubeVideo slot="figure" videoId="Szj-6F07oy0" />
    <span slot="caption">Optimal Policy -- <strong>S.R.</strong> [0/32]</span>
  </Figure>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="QPH8jvDvSAM" />
    <span slot="caption">Upright-Robust Baseline -- <strong>S.R.</strong> [13/32]</span>
  </Figure>
</ThreeColumns>
<ThreeColumns>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="y-vgT4wbG-g" />
    <span slot="caption">COM-Robust Policy -- <strong>N.C.S.</strong> [32/32]</span>
  </Figure>
  <Figure slot="center">
    <YouTubeVideo slot="figure" videoId="69DSX8XYZVg" />
    <span slot="caption">Optimal Policy -- <strong>N.C.S.</strong> [0/32]</span>
  </Figure>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="OpuBcsAeLQk" />
    <span slot="caption">Upright-Robust Baseline -- <strong>N.C.S.</strong> [*/32]</span>
  </Figure>
</ThreeColumns>

## Multi-Robust Vs. Optimal

For objects with pose uncertainity (i.e. Multi-object transportation), Multi-Robust policy is more stable yet slower.

<h3 style="text-align: center">--------------- (Noodles) ---------------</h3>
<TwoColumns>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="Z0XtRTMK_iI" />
    <span slot="caption"> Multi-Robust Policy  -- <strong>S.R.</strong> [32/32]</span>
  </Figure>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="W1tDtH7XRQs" />
    <span slot="caption"> Optimal Policy -- <strong>S.R.</strong> [18/32]</span>
  </Figure>
</TwoColumns>
<TwoColumns>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="69lIC0Mm9yQ" />
    <span slot="caption">Multi-Robust Policy -- <strong>N.C.S.</strong> [32/32]</span>
  </Figure>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="fTvm-CGpfos" />
    <span slot="caption">Optimal Policy -- <strong>N.C.S.</strong> [5/32]</span>
  </Figure>
</TwoColumns>

<h3 style="text-align: center">--------------- (Bottles) ---------------</h3>

<TwoColumns>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="epG7axDext0" />
    <span slot="caption"> Multi-Robust Policy  -- <strong>S.R.</strong> [32/32]</span>
  </Figure>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="pWhoW73yChs" />
    <span slot="caption"> Optimal Policy -- <strong>S.R.</strong> [0/32]</span>
  </Figure>
</TwoColumns>
<TwoColumns>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="HMh7PN9bx_Q" />
    <span slot="caption">Multi-Robust Policy -- <strong>N.C.S.</strong> [32/32]</span>
  </Figure>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="fn8P6RxZKU4" />
    <span slot="caption">Optimal Policy -- <strong>N.C.S.</strong> [0/32]</span>
  </Figure>
</TwoColumns>


## Friction Coefficient Variations

We test performance of Optimal policy for two surfaces rubber (<LaTeX inline formula="\mu=0.8" />) and paper (<LaTeX inline formula="\mu=0.4" />). Different trajectories are generated by varying the input friction to the policy. It is always safer to assume low friction (<LaTeX inline formula="\mu=0.1" />). High-friction surfaces fails due to tilting, while low-friction surfaces failed to slippage.

<h3 style="text-align: center">--------------- (<LaTeX inline formula="\mu=0.1" />) ---------------</h3>
<TwoColumns>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="EbINYPfl_5Y" />
    <span slot="caption"> Paper -- <strong>S.R.</strong> [32/32]</span>
  </Figure>
  <Figure slot="left">
    <span slot="caption"> Rubber -- <strong>S.R.</strong> [32/32]</span>
  </Figure>
</TwoColumns>
<TwoColumns>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="S1WnOpCSgmU" />
    <span slot="caption"> Rubber -- <strong>N.C.S.</strong> [32/32]</span>
  </Figure>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="_Ox-iBJwflI" />
    <span slot="caption"> Paper -- <strong>N.C.S.</strong> [13/32]</span>
  </Figure>
</TwoColumns>


<h3 style="text-align: center">--------------- (<LaTeX inline formula="\mu=0.2" />) ---------------</h3>

<TwoColumns>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="tSe2LXKlIcQ" />
    <span slot="caption"> Paper -- <strong>S.R.</strong> [32/32]</span>
  </Figure>
  <Figure slot="left">
    <span slot="caption"> Rubber -- <strong>S.R.</strong> [32/32]</span>
  </Figure>
</TwoColumns>
<TwoColumns>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="wuPYgTjuEGg" />
    <span slot="caption"> Rubber -- <strong>N.C.S.</strong> [32/32]</span>
  </Figure>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="Bq4xXNTHGDU" />
    <span slot="caption"> Paper -- <strong>N.C.S.</strong> [4/32]</span>
  </Figure>
</TwoColumns>

<h3 style="text-align: center">--------------- (<LaTeX inline formula="\mu=0.3" />) ---------------</h3>
<TwoColumns>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="mqDQRscx2lU" />
    <span slot="caption"> Paper -- <strong>S.R.</strong> [25/32]</span>
  </Figure>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="F40W1AANGTc" />
    <span slot="caption"> Rubber -- <strong>S.R.</strong> [32/32]</span>
  </Figure>
</TwoColumns>
<TwoColumns>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="DXm9O0D05DA" />
    <span slot="caption"> Rubber -- <strong>N.C.S.</strong> [29/32]</span>
  </Figure>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="B5pcR3HI5Yg" />
    <span slot="caption"> Paper -- <strong>N.C.S.</strong> [2/32]</span>
  </Figure>
</TwoColumns>

<h3 style="text-align: center">--------------- (<LaTeX inline formula="\mu=0.4" />) ---------------</h3>
<TwoColumns>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="5LiW40p9yaQ" />
    <span slot="caption"> Paper -- <strong>S.R.</strong> [16/32]</span>
  </Figure>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="kZngfyY9768" />
    <span slot="caption"> Rubber -- <strong>S.R.</strong> [32/32]</span>
  </Figure>
</TwoColumns>
<TwoColumns>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="N5wtKzsC_MQ" />
    <span slot="caption"> Rubber -- <strong>N.C.S.</strong> [4/32]</span>
  </Figure>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="lF-LKThNIM0" />
    <span slot="caption"> Paper -- <strong>N.C.S.</strong> [1/32]</span>
  </Figure>
</TwoColumns>


<h3 style="text-align: center">--------------- (<LaTeX inline formula="\mu=0.5" />) ---------------</h3>
<TwoColumns>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="JuBPAisngOk" />
    <span slot="caption"> Paper -- <strong>S.R.</strong> [11/32]</span>
  </Figure>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="aShePWRzhxw" />
    <span slot="caption"> Rubber -- <strong>S.R.</strong> [25/32]</span>
  </Figure>
</TwoColumns>
<TwoColumns>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="ldP0EEFQokY" />
    <span slot="caption"> Rubber -- <strong>N.C.S.</strong> [5/32]</span>
  </Figure>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="HXJdGW9n2M0" />
    <span slot="caption"> Paper -- <strong>N.C.S.</strong> [1/32]</span>
  </Figure>
</TwoColumns>

<h3 style="text-align: center">--------------- (<LaTeX inline formula="\mu=1.0" />) ---------------</h3>
<TwoColumns>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="N5YCPqhpQU4" />
    <span slot="caption"> Paper -- <strong>S.R.</strong> [8/32]</span>
  </Figure>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="JebB11defzY" />
    <span slot="caption"> Rubber -- <strong>S.R.</strong> [22/32]</span>
  </Figure>
</TwoColumns>
<TwoColumns>
  <Figure slot="left">
    <YouTubeVideo slot="figure" videoId="0wv6vjSB8PI" />
    <span slot="caption"> Rubber -- <strong>N.C.S.</strong> [5/32]</span>
  </Figure>
  <Figure slot="right">
    <YouTubeVideo slot="figure" videoId="JdZkWJH1SD8" />
    <span slot="caption"> Paper -- <strong>N.C.S.</strong> [1/32]</span>
  </Figure>
</TwoColumns>


## Extra Footage
### NoodlesTower
Multiple stacked objects 
<Figure>
  <YouTubeVideo slot="figure" videoId="9VUIa_-5jJM" />
  <span slot="caption">Multi-Robust Policy -- <strong>N.C.S.</strong> [8/32]</span>
</Figure>
### Safe Self-Collision in Upright-Robust Baseline Pybullet Simulation
Despite success in simulation, many real trajectories failed under Upright-Robust baseline. Due to different contact models and approximated geometry, collision only caused moderate sliding in simulation. On hardware, the object (pitcher) didn't slide and tilted aggressively before falling.
<Video source={pyb_vid} />

## BibTeX citation

```bibtex
@misc{neuralNPT_ral2025,
  author = "{Author One}",
  title = "Neural-NPT: A Reinforcement Learning Perspective to Dynamic Non-Prehensile Object Transportation",
  year = "2025",
}
```